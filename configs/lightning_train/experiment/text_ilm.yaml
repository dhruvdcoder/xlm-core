# @package _global_
defaults:
  - override /noise_schedule: dummy # default
  - override /model_type: ilm_stopping # discrete_time_absorbing
  - override /model: rotary_transformer_small_ilm_stopping
  

per_device_batch_size: 64
global_batch_size: 512
block_size: 128


log_predictions:
  _target_: xlm.harness.LogPredictions
  fields_to_keep_in_output:
    - text
  inject_target: null

callbacks:
  checkpoint_monitor:
    monitor: val/lm/accumulated_loss

datamodule:
  print_batch_fn: xlm.lm.ilm.datamodule_ilm.print_batch_ilm
  dataset_managers:
    val:
      unconditional_prediction:
        dataset_constructor_str: xlm.lm.ilm.datamodule_ilm.ILMEmptyDataset



trainer:
  max_steps: 1000_000 # 1M
  val_check_interval: 50000
  num_sanity_val_steps: 3